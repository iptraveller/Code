<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>终端库</title>
    <div th:remove="all">
        <title>终端库</title>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <!-- Tell the browser to be responsive to screen width -->
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
        <!-- Bootstrap 3.3.6 -->
        <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css"/>
        <!-- Font Awesome -->
        <link rel="stylesheet" href="../dist/third/font-awesome.min.css"/>
        <!-- Ionicons -->
        <link rel="stylesheet" href="../dist/third/ionicons.min.css"/>

        <!-- Theme style -->
        <link rel="stylesheet" href="../dist/css/AdminLTE.min.css"/>
        <!-- AdminLTE Skins. Choose a skin from the css/skins
             folder instead of downloading all of them to reduce the load. -->
        <link rel="stylesheet" href="../dist/css/skins/_all-skins.min.css"/>

        <!-- iCheck -->
        <link rel="stylesheet" href="../plugins/iCheck/square/blue.css"/>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </div>
    <div th:replace="head"></div>

</head>

<body class="hold-transition skin-blue sidebar-mini ">
<div class="wrapper">

    <header class="main-header" th:remove="all">

        <!-- Logo -->
        <a href="@{/}" class="logo">
            <span class="logo-mini"></span>
            <!-- logo for regular state and mobile devices -->
            <span class="logo-lg"></span>
        </a>

        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top">
            <!-- Sidebar toggle button-->
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
            </a>
            <!-- Navbar Right Menu -->
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                </ul>
            </div>

        </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar" th:remove="all">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">

            <!-- sidebar menu: : style can be found in sidebar.less -->
            <ul class="sidebar-menu">

                <!--Multilevel-->
                <li class="treeview" th:each="nav:${navs}">
                    <a href="#" th:href="@{${nav.url}">
                        <span th:text="${nav.label}">label</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
                    </a>
                    <ul class="treeview-menu" th:each="second:${navs.children}">
                        <li><a href="#" th:href="@{${second.url}"><i class="fa fa-circle-o"></i> <span
                                th:text="${second.label}">label</span></a></li>
                    </ul>
                </li>

            </ul>
        </section>
        <!-- /.sidebar -->
    </aside>

    <div th:replace="header"></div>
    <div th:replace="sidebar"></div>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">


        <!-- Main content -->
        <section class="content">
            <!-- Info boxes -->
            <div class="row">
                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box">
                        <span class="info-box-icon bg-yellow"><i class="ion ion-ios-people-outline"></i></span>

                        <div class="info-box-content">
                            <span class="info-box-text">终端总数</span>
                            <span class="info-box-number" th:text="${staNum}">staNum</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>
                    <!-- /.info-box -->
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="box">
                        <div class="box-header with-border">
                        </div>
                        <!-- /.box-header -->

                        <div class="box-body">
                            <div id="sta_count_chart" style="width:1200px; height: 300px;"></div>
                            <div id="sta_project_chart" style="width:1200px; height: 400px;"></div>
                            <div id="sta_province_chart" style="width:1200px; height: 300px;"></div>
                            <div id="sta_industry_chart" style="width:1200px; height: 300px;"></div>
                        </div>
                        <!-- ./box-body -->
                    </div>
                    <!-- /.box -->
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->

        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

</div>

<div th:replace="script"></div>
<div th:remove="all">
    <!-- jQuery 2.2.3 -->
    <script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
    <!-- Bootstrap 3.3.6 -->
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="../plugins/fastclick/fastclick.js"></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/app.min.js"></script>
    <!-- Sparkline -->
    <script src="../plugins/sparkline/jquery.sparkline.min.js"></script>

    <!-- SlimScroll 1.3.0 -->
    <script src="../plugins/slimScroll/jquery.slimscroll.min.js"></script>

    <!-- DataTables -->
    <script src="../plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="../plugins/datatables/dataTables.bootstrap.min.js"></script>

</div>
</body>
<script th:src="@{/js/echarts.min.js}"></script>
<script type="text/javascript">
    Date.prototype.Format = function (fmt) {
        var o = {
            "y+": this.getFullYear(),
            "M+": this.getMonth() + 1,                 //月份
            "d+": this.getDate(),                    //日
            "h+": this.getHours(),                   //小时
            "m+": this.getMinutes(),                 //分
            "s+": this.getSeconds(),                 //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S+": this.getMilliseconds()             //毫秒
        };
        for (var k in o) {
            if (new RegExp("(" + k + ")").test(fmt)){
                if(k == "y+"){
                    fmt = fmt.replace(RegExp.$1, ("" + o[k]).substr(4 - RegExp.$1.length));
                }
                else if(k=="S+"){
                    var lens = RegExp.$1.length;
                    lens = lens==1?3:lens;
                    fmt = fmt.replace(RegExp.$1, ("00" + o[k]).substr(("" + o[k]).length - 1,lens));
                }
                else{
                    fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                }
            }
        }
        return fmt;
    }

    $.ajax({
        "type":"post",
        "async":false,
        "url":"/sta/getStaCountList",
        "dataType":"json",
        "success":function(response) {
            var wisTotalCount = response.wisTotalCount
            var mohooTotalCount = response.mohooTotalCount
            var xData = []
            var serialWis = []
            var serialMohoo = []
            response.forEach(function(value) {
                var time = new Date(value.date)
                xData.push(time.Format("yyyy-MM-dd"))
                serialWis.push(value.wisTotalCount)
                serialMohoo.push(value.mohooTotalCount)
            });
            var option = {
                title : {
                    text: '终端总数',
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['wis终端','魔盒终端']
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        boundaryGap : false,
                        data : xData
                    }
                ],
                yAxis : [
                    {
                        type: 'value'
                    }
                ],
                series : [
                    {
                        name:'wis终端',
                        type:'line',
                        data:serialWis
                    },
                    {
                        name:'魔盒终端',
                        type:'line',
                        data:serialMohoo
                    }
                ]
            };
            //初始化echarts实例
            var myChart = echarts.init(document.getElementById('sta_count_chart'));
            //使用制定的配置项和数据显示图表
            myChart.setOption(option);
        }
    });

    $.ajax({
        "type":"post",
        "async":false,
        "url":"/sta/getStaIndustryList",
        "dataType":"json",
        "success":function(response) {
            var dateList = response.date
            var university = response.university
            var sell = response.sell
            var finance = response.finance
            var telcom = response.telcom
            var energy = response.energy
            var oversea = response.oversea
            var service = response.service
            var school = response.school
            var government = response.government
            var hospital = response.hospital
            var manufacturing = response.manufacturing
            var enterprise = response.enterprise
            var traffic = response.traffic
            var internet = response.internet
            var others = response.others

            var xData = []
            dateList.forEach(function(value) {
                var time = new Date(value)
                xData.push(time.Format("yyyy-MM-dd"))
            });

            var option = {
                title : {
                    text: '行业累计终端'
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['高教','运营商','医疗','企业其他','服务业','交通','政府','普教','金融','','零售','制造业']
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        boundaryGap : false,
                        data : xData
                    }
                ],
                color: [
                    '#1e90ff', '#ff6347', '#7b68ee', '#00fa9a', '#40e0d0',
                    '#ff69b4', '#ba55d3', '#cd5c5c', '#ffa500', '#ffd700',
                    '#6b8e23', '#ff00ff', '#3cb371', '#b8860b', '#30e0e0',
                    '#ff7f50', '#87cefa', '#da70d6', '#32cd32', '#6495ed'
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'高教',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:university
                    },
                    {
                        name:'运营商',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:telcom
                    },
                    {
                        name:'医疗',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:hospital
                    },
                    {
                        name:'企业其他',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:enterprise
                    },
                    {
                        name:'服务业',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:service
                    },
                    {
                        name:'交通',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:traffic
                    },
                    {
                        name:'政府',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:government
                    },
                    {
                        name:'普教',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:school
                    },
                    {
                        name:'金融',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:finance
                    },
                    {
                        name:'零售',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal:{areaStyle: {type: 'default'}}},
                        data:sell
                    },
                    {
                        name:'制造业',
                        type:'line',
                        stack: '总量',
                        itemStyle: {normal: {areaStyle: {type: 'default'}}},
                        data:manufacturing
                    }
                ]
            };



            //初始化echarts实例
            var myChart = echarts.init(document.getElementById('sta_industry_chart'));
            //使用制定的配置项和数据显示图表
            myChart.setOption(option);
        }
    });

    $.ajax({
        "type":"post",
        "async":false,
        "url":"/sta/getStaCountProject",
        "dataType":"json",
        "success":function(response) {
            var xData = []
            var count = []
            response.forEach(function(value) {
                xData.push(value.projectName)
                count.push(value.count)
            });

            var option = {
                title : {
                    text: '项目终端统计Top 20',
                },
                tooltip : {
                    trigger: 'axis'
                },
                grid : {
                    y2: 150
                },
                legend: {
                    data:['累计终端']
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        axisLabel:{
                            interval: 0,
                            rotate:30
                        },
                        data : xData
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'累计终端',
                        type:'bar',
                        itemStyle: {
                            normal: {
                                color: "#ff0b00"
                            }
                        },
                        data:count
                    }
                ]
            };

            //初始化echarts实例
            var myChart = echarts.init(document.getElementById('sta_project_chart'));
            //使用制定的配置项和数据显示图表
            myChart.setOption(option);
        }
    });

    $.ajax({
        "type":"post",
        "async":false,
        "url":"/sta/getStaCountProvince",
        "dataType":"json",
        "success":function(response) {
            var xData = []
            var count = []
            response.forEach(function(value) {
                xData.push(value.province)
                count.push(value.count)
            });

            var option = {
                title : {
                    text: '区域终端统计',
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['累计终端']
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        axisLabel:{
                            interval: 0,
                            rotate:30
                        },
                        data : xData
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'累计终端',
                        type:'bar',
                        itemStyle: {
                            normal: {
                                color: "#ff0b00"
                            }
                        },
                        data:count
                    }
                ]
            };

            //初始化echarts实例
            var myChart = echarts.init(document.getElementById('sta_province_chart'));
            //使用制定的配置项和数据显示图表
            myChart.setOption(option);
        }
    });
</script>
</html>